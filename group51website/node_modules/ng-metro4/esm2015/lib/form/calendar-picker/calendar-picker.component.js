var CalendarPickerComponent_1;
import { __decorate, __metadata } from "tslib";
import { ChangeDetectionStrategy, Component, ElementRef, Input, ViewChild } from '@angular/core';
import { DefaultValueAccessor } from '../../helper/default-value-accessor';
import { ControlBase } from '../control-base';
import * as moment from 'moment';
import { TypeAlias } from '../../helper/type-alias';
import { asapScheduler } from 'rxjs';
import { ObjectHelper } from '../../helper/object-helper';
const _moment = moment;
let CalendarPickerComponent = CalendarPickerComponent_1 = class CalendarPickerComponent extends ControlBase {
    createControl() {
        return new Promise((complete) => {
            const originalElement = $(this.input.nativeElement);
            ObjectHelper.hide(originalElement);
            if (this.clonedElement) {
                this.clonedElement.parent().remove();
            }
            this.clonedElement = originalElement.clone();
            ObjectHelper.show(this.clonedElement);
            originalElement.parent().append(this.clonedElement);
            this.calendarPicker = this.clonedElement.calendarpicker().data('calendarpicker');
            this.clonedElement.one('blur', () => {
                this.touchCallback();
            });
            this.calendarPicker.options.onChange = () => {
                asapScheduler.schedule(() => {
                    const val = this.calendarPicker.value;
                    this.changeValue(val ? _moment(val.toLocaleDateString('en'), 'MM/DD/YYYY') : null);
                });
            };
            complete();
        });
    }
    disable(disabled) {
        asapScheduler.schedule(() => {
            if (disabled) {
                this.calendarPicker.disable();
            }
            else {
                this.calendarPicker.enable();
            }
        });
    }
    newValue() {
        if (!this.calendarPicker) {
            return;
        }
        asapScheduler.schedule(() => {
            this.calendarPicker.val(this.innerValue ? this.innerValue.format('MM/DD/YYYY') : '01/01/0000');
        });
    }
    convertMomentArray(arr) {
        return arr ? arr.map(v => v.format('MM/DD/YYYY')).join(',') : null;
    }
    newClassValue(newClasses, oldClasses) {
        asapScheduler.schedule(() => {
            if (this.clonedElement) {
                const target = this.clonedElement.parent();
                oldClasses.forEach((cls) => {
                    target.removeClass(cls);
                });
                newClasses.forEach((cls) => {
                    target.addClass(cls);
                });
            }
        });
    }
};
__decorate([
    Input('calendar-wide'),
    __metadata("design:type", Boolean)
], CalendarPickerComponent.prototype, "calendarWide", void 0);
__decorate([
    Input('calendar-wide-point'),
    __metadata("design:type", String)
], CalendarPickerComponent.prototype, "calendarWidePoint", void 0);
__decorate([
    Input('dialog-mode'),
    __metadata("design:type", Boolean)
], CalendarPickerComponent.prototype, "dialogMode", void 0);
__decorate([
    Input('dialog-point'),
    __metadata("design:type", Number)
], CalendarPickerComponent.prototype, "dialogPoint", void 0);
__decorate([
    Input('dialog-overlay'),
    __metadata("design:type", Boolean)
], CalendarPickerComponent.prototype, "dialogOverlay", void 0);
__decorate([
    Input('overlay-color'),
    __metadata("design:type", String)
], CalendarPickerComponent.prototype, "overlayColor", void 0);
__decorate([
    Input('overlay-alpha'),
    __metadata("design:type", Number)
], CalendarPickerComponent.prototype, "overlayAlpha", void 0);
__decorate([
    Input('locale'),
    __metadata("design:type", String)
], CalendarPickerComponent.prototype, "locale", void 0);
__decorate([
    Input('size'),
    __metadata("design:type", String)
], CalendarPickerComponent.prototype, "size", void 0);
__decorate([
    Input('format'),
    __metadata("design:type", String)
], CalendarPickerComponent.prototype, "format", void 0);
__decorate([
    Input('clear-button'),
    __metadata("design:type", Boolean)
], CalendarPickerComponent.prototype, "clearButton", void 0);
__decorate([
    Input('clear-button-icon'),
    __metadata("design:type", String)
], CalendarPickerComponent.prototype, "clearButtonIcon", void 0);
__decorate([
    Input('calendar-button-icon'),
    __metadata("design:type", String)
], CalendarPickerComponent.prototype, "calendarButtonIcon", void 0);
__decorate([
    Input('years-before'),
    __metadata("design:type", Number)
], CalendarPickerComponent.prototype, "yearsBefore", void 0);
__decorate([
    Input('years-after'),
    __metadata("design:type", Number)
], CalendarPickerComponent.prototype, "yearsAfter", void 0);
__decorate([
    Input('week-start'),
    __metadata("design:type", Number)
], CalendarPickerComponent.prototype, "weekStart", void 0);
__decorate([
    Input('outside'),
    __metadata("design:type", Boolean)
], CalendarPickerComponent.prototype, "outside", void 0);
__decorate([
    Input('ripple'),
    __metadata("design:type", Boolean)
], CalendarPickerComponent.prototype, "ripple", void 0);
__decorate([
    Input('ripple-color'),
    __metadata("design:type", String)
], CalendarPickerComponent.prototype, "rippleColor", void 0);
__decorate([
    Input('exclude'),
    __metadata("design:type", Array)
], CalendarPickerComponent.prototype, "exclude", void 0);
__decorate([
    Input('include'),
    __metadata("design:type", Array)
], CalendarPickerComponent.prototype, "include", void 0);
__decorate([
    Input('min-date'),
    __metadata("design:type", Object)
], CalendarPickerComponent.prototype, "minDate", void 0);
__decorate([
    Input('max-date'),
    __metadata("design:type", Object)
], CalendarPickerComponent.prototype, "maxDate", void 0);
__decorate([
    Input('show-header'),
    __metadata("design:type", Boolean)
], CalendarPickerComponent.prototype, "showHeader", void 0);
__decorate([
    Input('cls-picker'),
    __metadata("design:type", String)
], CalendarPickerComponent.prototype, "clsPicker", void 0);
__decorate([
    Input('cls-today'),
    __metadata("design:type", String)
], CalendarPickerComponent.prototype, "clsToday", void 0);
__decorate([
    Input('cls-selected'),
    __metadata("design:type", String)
], CalendarPickerComponent.prototype, "clsSelected", void 0);
__decorate([
    Input('cls-exclude'),
    __metadata("design:type", String)
], CalendarPickerComponent.prototype, "clsExclude", void 0);
__decorate([
    Input('cls-calendar'),
    __metadata("design:type", String)
], CalendarPickerComponent.prototype, "clsCalendar", void 0);
__decorate([
    Input('cls-calendar-header'),
    __metadata("design:type", String)
], CalendarPickerComponent.prototype, "clsCalendarHeader", void 0);
__decorate([
    Input('cls-calendar-content'),
    __metadata("design:type", String)
], CalendarPickerComponent.prototype, "clsCalendarContent", void 0);
__decorate([
    Input('cls-calendar-months'),
    __metadata("design:type", String)
], CalendarPickerComponent.prototype, "clsCalendarMonths", void 0);
__decorate([
    Input('cls-calendar-years'),
    __metadata("design:type", String)
], CalendarPickerComponent.prototype, "clsCalendarYears", void 0);
__decorate([
    ViewChild('input', { static: true }),
    __metadata("design:type", ElementRef)
], CalendarPickerComponent.prototype, "input", void 0);
CalendarPickerComponent = CalendarPickerComponent_1 = __decorate([
    Component({
        selector: 'm4-calendar-picker',
        template: "<input type=\"text\" #input\r\n\r\n       data-input-format=\"%m/%d/%Y\"\r\n\r\n       [attr.data-calendar-wide]=\"calendarWide\"\r\n       [attr.data-calendar-wide-point]=\"calendarWidePoint\"\r\n       [attr.data-dialog-mode]=\"dialogMode\"\r\n       [attr.data-dialog-point]=\"dialogPoint\"\r\n       [attr.data-dialog-overlay]=\"dialogOverlay\"\r\n       [attr.data-overlay-color]=\"overlayColor\"\r\n       [attr.data-overlay-alpha]=\"overlayAlpha\"\r\n       [attr.data-locale]=\"locale\"\r\n       [attr.data-size]=\"size\"\r\n       [attr.data-format]=\"format\"\r\n       [attr.data-clear-button]=\"clearButton\"\r\n       [attr.data-clear-button-icon]=\"clearButtonIcon\"\r\n       [attr.data-calendar-button-icon]=\"calendarButtonIcon\"\r\n       [attr.data-years-before]=\"yearsBefore\"\r\n       [attr.data-years-after]=\"yearsAfter\"\r\n       [attr.data-week-start]=\"weekStart\"\r\n       [attr.data-outside]=\"outside\"\r\n       [attr.data-ripple]=\"ripple\"\r\n       [attr.data-ripple-color]=\"rippleColor\"\r\n       [attr.data-exclude]=\"convertMomentArray(exclude)\"\r\n       [attr.data-special]=\"convertMomentArray(include)\"\r\n       [attr.data-min-date]=\"minDate?.format('MM/DD/YYYY')\"\r\n       [attr.data-max-date]=\"maxDate?.format('MM/DD/YYYY')\"\r\n       [attr.data-show-header]=\"showHeader\"\r\n\r\n       [attr.data-cls-picker]=\"clsPicker\"\r\n       [attr.data-cls-today]=\"clsToday\"\r\n       [attr.data-cls-selected]=\"clsSelected\"\r\n       [attr.data-cls-exclude]=\"clsExclude\"\r\n       [attr.data-cls-calendar]=\"clsCalendar\"\r\n       [attr.data-cls-calendar-header]=\"clsCalendarHeader\"\r\n       [attr.data-cls-calendar-content]=\"clsCalendarContent\"\r\n       [attr.data-cls-calendar-months]=\"clsCalendarMonths\"\r\n       [attr.data-cls-calendar-years]=\"clsCalendarYears\">\r\n",
        providers: [DefaultValueAccessor.get(CalendarPickerComponent_1), TypeAlias.get(CalendarPickerComponent_1)],
        changeDetection: ChangeDetectionStrategy.OnPush,
        styles: [""]
    })
], CalendarPickerComponent);
export { CalendarPickerComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FsZW5kYXItcGlja2VyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25nLW1ldHJvNC8iLCJzb3VyY2VzIjpbImxpYi9mb3JtL2NhbGVuZGFyLXBpY2tlci9jYWxlbmRhci1waWNrZXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsT0FBTyxFQUFDLHVCQUF1QixFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUMvRixPQUFPLEVBQUMsb0JBQW9CLEVBQUMsTUFBTSxxQ0FBcUMsQ0FBQztBQUN6RSxPQUFPLEVBQUMsV0FBVyxFQUFDLE1BQU0saUJBQWlCLENBQUM7QUFDNUMsT0FBTyxLQUFLLE1BQU0sTUFBTSxRQUFRLENBQUM7QUFFakMsT0FBTyxFQUFDLFNBQVMsRUFBQyxNQUFNLHlCQUF5QixDQUFDO0FBQ2xELE9BQU8sRUFBQyxhQUFhLEVBQUMsTUFBTSxNQUFNLENBQUM7QUFDbkMsT0FBTyxFQUFDLFlBQVksRUFBQyxNQUFNLDRCQUE0QixDQUFDO0FBRXhELE1BQU0sT0FBTyxHQUFHLE1BQU0sQ0FBQztBQVV2QixJQUFhLHVCQUF1QiwrQkFBcEMsTUFBYSx1QkFBd0IsU0FBUSxXQUEwQjtJQXlDckUsYUFBYTtRQUNYLE9BQU8sSUFBSSxPQUFPLENBQU8sQ0FBQyxRQUFRLEVBQUUsRUFBRTtZQUNwQyxNQUFNLGVBQWUsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsQ0FBQztZQUNwRCxZQUFZLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDO1lBRW5DLElBQUksSUFBSSxDQUFDLGFBQWEsRUFBRTtnQkFDdEIsSUFBSSxDQUFDLGFBQWEsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxNQUFNLEVBQUUsQ0FBQzthQUN0QztZQUVELElBQUksQ0FBQyxhQUFhLEdBQUcsZUFBZSxDQUFDLEtBQUssRUFBRSxDQUFDO1lBQzdD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QUMsYUFBYSxDQUFDOzsyREFBcUI7QUFFckI7SUFBcEIsS0FBSyxDQUFDLFlBQVksQ0FBQzs7MERBQW1CO0FBQ25CO0lBQW5CLEtBQUssQ0FBQyxXQUFXLENBQUM7O3lEQUFrQjtBQUNkO0lBQXRCLEtBQUssQ0FBQyxjQUFjLENBQUM7OzREQUFxQjtBQUNyQjtJQUFyQixLQUFLLENBQUMsYUFBYSxDQUFDOzsyREFBb0I7QUFDbEI7SUFBdEIsS0FBSyxDQUFDLGNBQWMsQ0FBQzs7NERBQXFCO0FBQ2I7SUFBN0IsS0FBSyxDQUFDLHFCQUFxQixDQUFDOztrRUFBMkI7QUFDekI7SUFBOUIsS0FBSyxDQUFDLHNCQUFzQixDQUFDOzttRUFBNEI7QUFDNUI7SUFBN0IsS0FBSyxDQUFDLHFCQUFxQixDQUFDOztrRUFBMkI7QUFDM0I7SUFBNUIsS0FBSyxDQUFDLG9CQUFvQixDQUFDOztpRUFBMEI7QUFFaEI7SUFBckMsU0FBUyxDQUFDLE9BQU8sRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsQ0FBQzs4QkFBZ0IsVUFBVTtzREFBQztBQXJDckQsdUJBQXVCO0lBUG5DLFNBQVMsQ0FBQztRQUNULFFBQVEsRUFBRSxvQkFBb0I7UUFDOUIsMHpEQUErQztRQUUvQyxTQUFTLEVBQUUsQ0FBQyxvQkFBb0IsQ0FBQyxHQUFHLENBQUMseUJBQXVCLENBQUMsRUFBRSxTQUFTLENBQUMsR0FBRyxDQUFDLHlCQUF1QixDQUFDLENBQUM7UUFDdEcsZUFBZSxFQUFFLHVCQUF1QixDQUFDLE1BQU07O0tBQ2hELENBQUM7R0FDVyx1QkFBdUIsQ0ErR25DO1NBL0dZLHVCQUF1QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Q2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksIENvbXBvbmVudCwgRWxlbWVudFJlZiwgSW5wdXQsIFZpZXdDaGlsZH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7RGVmYXVsdFZhbHVlQWNjZXNzb3J9IGZyb20gJy4uLy4uL2hlbHBlci9kZWZhdWx0LXZhbHVlLWFjY2Vzc29yJztcclxuaW1wb3J0IHtDb250cm9sQmFzZX0gZnJvbSAnLi4vY29udHJvbC1iYXNlJztcclxuaW1wb3J0ICogYXMgbW9tZW50IGZyb20gJ21vbWVudCc7XHJcbmltcG9ydCB7V2lkZVBvaW50VHlwZX0gZnJvbSAnLi4vLi4vaGVscGVyL3R5cGVzJztcclxuaW1wb3J0IHtUeXBlQWxpYXN9IGZyb20gJy4uLy4uL2hlbHBlci90eXBlLWFsaWFzJztcclxuaW1wb3J0IHthc2FwU2NoZWR1bGVyfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHtPYmplY3RIZWxwZXJ9IGZyb20gJy4uLy4uL2hlbHBlci9vYmplY3QtaGVscGVyJztcclxuXHJcbmNvbnN0IF9tb21lbnQgPSBtb21lbnQ7XHJcbmRlY2xhcmUgdmFyICQ6IGFueTtcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnbTQtY2FsZW5kYXItcGlja2VyJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vY2FsZW5kYXItcGlja2VyLmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6IFsnLi9jYWxlbmRhci1waWNrZXIuY29tcG9uZW50LmNzcyddLFxyXG4gIHByb3ZpZGVyczogW0RlZmF1bHRWYWx1ZUFjY2Vzc29yLmdldChDYWxlbmRhclBpY2tlckNvbXBvbmVudCksIFR5cGVBbGlhcy5nZXQoQ2FsZW5kYXJQaWNrZXJDb21wb25lbnQpXSxcclxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaFxyXG59KVxyXG5leHBvcnQgY2xhc3MgQ2FsZW5kYXJQaWNrZXJDb21wb25lbnQgZXh0ZW5kcyBDb250cm9sQmFzZTxtb21lbnQuTW9tZW50PiB7XHJcblxyXG4gIEBJbnB1dCgnY2FsZW5kYXItd2lkZScpIGNhbGVuZGFyV2lkZTogYm9vbGVhbjtcclxuICBASW5wdXQoJ2NhbGVuZGFyLXdpZGUtcG9pbnQnKSBjYWxlbmRhcldpZGVQb2ludDogV2lkZVBvaW50VHlwZTtcclxuICBASW5wdXQoJ2RpYWxvZy1tb2RlJykgZGlhbG9nTW9kZTogYm9vbGVhbjtcclxuICBASW5wdXQoJ2RpYWxvZy1wb2ludCcpIGRpYWxvZ1BvaW50OiBudW1iZXI7XHJcbiAgQElucHV0KCdkaWFsb2ctb3ZlcmxheScpIGRpYWxvZ092ZXJsYXk6IGJvb2xlYW47XHJcbiAgQElucHV0KCdvdmVybGF5LWNvbG9yJykgb3ZlcmxheUNvbG9yOiBzdHJpbmc7XHJcbiAgQElucHV0KCdvdmVybGF5LWFscGhhJykgb3ZlcmxheUFscGhhOiBudW1iZXI7XHJcbiAgQElucHV0KCdsb2NhbGUnKSBsb2NhbGU6IHN0cmluZztcclxuICBASW5wdXQoJ3NpemUnKSBzaXplOiBzdHJpbmc7XHJcbiAgQElucHV0KCdmb3JtYXQnKSBmb3JtYXQ6IHN0cmluZztcclxuICBASW5wdXQoJ2NsZWFyLWJ1dHRvbicpIGNsZWFyQnV0dG9uOiBib29sZWFuO1xyXG4gIEBJbnB1dCgnY2xlYXItYnV0dG9uLWljb24nKSBjbGVhckJ1dHRvbkljb246IHN0cmluZztcclxuICBASW5wdXQoJ2NhbGVuZGFyLWJ1dHRvbi1pY29uJykgY2FsZW5kYXJCdXR0b25JY29uOiBzdHJpbmc7XHJcbiAgQElucHV0KCd5ZWFycy1iZWZvcmUnKSB5ZWFyc0JlZm9yZTogbnVtYmVyO1xyXG4gIEBJbnB1dCgneWVhcnMtYWZ0ZXInKSB5ZWFyc0FmdGVyOiBudW1iZXI7XHJcbiAgQElucHV0KCd3ZWVrLXN0YXJ0Jykgd2Vla1N0YXJ0OiAwfDE7XHJcbiAgQElucHV0KCdvdXRzaWRlJykgb3V0c2lkZTogYm9vbGVhbjtcclxuICBASW5wdXQoJ3JpcHBsZScpIHJpcHBsZTogYm9vbGVhbjtcclxuICBASW5wdXQoJ3JpcHBsZS1jb2xvcicpIHJpcHBsZUNvbG9yOiBzdHJpbmc7XHJcbiAgQElucHV0KCdleGNsdWRlJykgZXhjbHVkZTogbW9tZW50Lk1vbWVudFtdO1xyXG4gIEBJbnB1dCgnaW5jbHVkZScpIGluY2x1ZGU6IG1vbWVudC5Nb21lbnRbXTtcclxuICBASW5wdXQoJ21pbi1kYXRlJykgbWluRGF0ZTogbW9tZW50Lk1vbWVudDtcclxuICBASW5wdXQoJ21heC1kYXRlJykgbWF4RGF0ZTogbW9tZW50Lk1vbWVudDtcclxuICBASW5wdXQoJ3Nob3ctaGVhZGVyJykgc2hvd0hlYWRlcjogYm9vbGVhbjtcclxuXHJcbiAgQElucHV0KCdjbHMtcGlja2VyJykgY2xzUGlja2VyOiBzdHJpbmc7XHJcbiAgQElucHV0KCdjbHMtdG9kYXknKSBjbHNUb2RheTogc3RyaW5nO1xyXG4gIEBJbnB1dCgnY2xzLXNlbGVjdGVkJykgY2xzU2VsZWN0ZWQ6IHN0cmluZztcclxuICBASW5wdXQoJ2Nscy1leGNsdWRlJykgY2xzRXhjbHVkZTogc3RyaW5nO1xyXG4gIEBJbnB1dCgnY2xzLWNhbGVuZGFyJykgY2xzQ2FsZW5kYXI6IHN0cmluZztcclxuICBASW5wdXQoJ2Nscy1jYWxlbmRhci1oZWFkZXInKSBjbHNDYWxlbmRhckhlYWRlcjogc3RyaW5nO1xyXG4gIEBJbnB1dCgnY2xzLWNhbGVuZGFyLWNvbnRlbnQnKSBjbHNDYWxlbmRhckNvbnRlbnQ6IHN0cmluZztcclxuICBASW5wdXQoJ2Nscy1jYWxlbmRhci1tb250aHMnKSBjbHNDYWxlbmRhck1vbnRoczogc3RyaW5nO1xyXG4gIEBJbnB1dCgnY2xzLWNhbGVuZGFyLXllYXJzJykgY2xzQ2FsZW5kYXJZZWFyczogc3RyaW5nO1xyXG5cclxuICBAVmlld0NoaWxkKCdpbnB1dCcsIHsgc3RhdGljOiB0cnVlIH0pIHByaXZhdGUgaW5wdXQ6IEVsZW1lbnRSZWY7XHJcbiAgcHJpdmF0ZSBjYWxlbmRhclBpY2tlcjogYW55O1xyXG4gIHByaXZhdGUgY2xvbmVkRWxlbWVudDogYW55O1xyXG5cclxuICBjcmVhdGVDb250cm9sKCkge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPHZvaWQ+KChjb21wbGV0ZSkgPT4ge1xyXG4gICAgICBjb25zdCBvcmlnaW5hbEVsZW1lbnQgPSAkKHRoaXMuaW5wdXQubmF0aXZlRWxlbWVudCk7XHJcbiAgICAgIE9iamVjdEhlbHBlci5oaWRlKG9yaWdpbmFsRWxlbWVudCk7XHJcblxyXG4gICAgICBpZiAodGhpcy5jbG9uZWRFbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5jbG9uZWRFbGVtZW50LnBhcmVudCgpLnJlbW92ZSgpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB0aGlzLmNsb25lZEVsZW1lbnQgPSBvcmlnaW5hbEVsZW1lbnQuY2xvbmUoKTtcclxuICAgICAgT2JqZWN0SGVscGVyLnNob3codGhpcy5jbG9uZWRFbGVtZW50KTtcclxuICAgICAgb3JpZ2luYWxFbGVtZW50LnBhcmVudCgpLmFwcGVuZCh0aGlzLmNsb25lZEVsZW1lbnQpO1xyXG5cclxuICAgICAgdGhpcy5jYWxlbmRhclBpY2tlciA9IHRoaXMuY2xvbmVkRWxlbWVudC5jYWxlbmRhcnBpY2tlcigpLmRhdGEoJ2NhbGVuZGFycGlja2VyJyk7XHJcblxyXG4gICAgICB0aGlzLmNsb25lZEVsZW1lbnQub25lKCdibHVyJywgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMudG91Y2hDYWxsYmFjaygpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHRoaXMuY2FsZW5kYXJQaWNrZXIub3B0aW9ucy5vbkNoYW5nZSA9ICgpID0+IHtcclxuICAgICAgICBhc2FwU2NoZWR1bGVyLnNjaGVkdWxlKCgpID0+IHtcclxuICAgICAgICAgIGNvbnN0IHZhbCA9IHRoaXMuY2FsZW5kYXJQaWNrZXIudmFsdWU7XHJcbiAgICAgICAgICB0aGlzLmNoYW5nZVZhbHVlKHZhbCA/IF9tb21lbnQodmFsLnRvTG9jYWxlRGF0ZVN0cmluZygnZW4nKSwgJ01NL0REL1lZWVknKSA6IG51bGwpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgY29tcGxldGUoKTtcclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIGRpc2FibGUoZGlzYWJsZWQ6IGJvb2xlYW4pOiB2b2lkIHtcclxuICAgIGFzYXBTY2hlZHVsZXIuc2NoZWR1bGUoKCkgPT4ge1xyXG4gICAgICBpZiAoZGlzYWJsZWQpIHtcclxuICAgICAgICB0aGlzLmNhbGVuZGFyUGlja2VyLmRpc2FibGUoKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLmNhbGVuZGFyUGlja2VyLmVuYWJsZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIG5ld1ZhbHVlKCk6IHZvaWQge1xyXG4gICAgaWYgKCF0aGlzLmNhbGVuZGFyUGlja2VyKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBhc2FwU2NoZWR1bGVyLnNjaGVkdWxlKCgpID0+IHtcclxuICAgICAgdGhpcy5jYWxlbmRhclBpY2tlci52YWwodGhpcy5pbm5lclZhbHVlID8gdGhpcy5pbm5lclZhbHVlLmZvcm1hdCgnTU0vREQvWVlZWScpIDogJzAxLzAxLzAwMDAnKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgY29udmVydE1vbWVudEFycmF5KGFycjogbW9tZW50Lk1vbWVudFtdKSB7XHJcbiAgICByZXR1cm4gYXJyID8gYXJyLm1hcCh2ID0+IHYuZm9ybWF0KCdNTS9ERC9ZWVlZJykpLmpvaW4oJywnKSA6IG51bGw7XHJcbiAgfVxyXG5cclxuICBuZXdDbGFzc1ZhbHVlKG5ld0NsYXNzZXM6IHN0cmluZ1tdLCBvbGRDbGFzc2VzOiBzdHJpbmdbXSkge1xyXG4gICAgYXNhcFNjaGVkdWxlci5zY2hlZHVsZSgoKSA9PiB7XHJcbiAgICAgIGlmICh0aGlzLmNsb25lZEVsZW1lbnQpIHtcclxuICAgICAgICBjb25zdCB0YXJnZXQgPSB0aGlzLmNsb25lZEVsZW1lbnQucGFyZW50KCk7XHJcblxyXG4gICAgICAgIG9sZENsYXNzZXMuZm9yRWFjaCgoY2xzOiBzdHJpbmcpID0+IHtcclxuICAgICAgICAgIHRhcmdldC5yZW1vdmVDbGFzcyhjbHMpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBuZXdDbGFzc2VzLmZvckVhY2goKGNsczogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgICB0YXJnZXQuYWRkQ2xhc3MoY2xzKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiJdfQ==