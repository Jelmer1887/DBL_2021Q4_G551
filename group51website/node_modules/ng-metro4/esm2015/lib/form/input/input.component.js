var InputComponent_1;
import { __decorate, __metadata } from "tslib";
import { ChangeDetectionStrategy, Component, ElementRef, EventEmitter, Input, Output, ViewChild, ViewEncapsulation } from '@angular/core';
import { ControlBase } from '../control-base';
import { DefaultValueAccessor } from '../../helper/default-value-accessor';
import { TypeAlias } from '../../helper/type-alias';
import { asapScheduler } from 'rxjs';
import { ObjectHelper } from '../../helper/object-helper';
let InputComponent = InputComponent_1 = class InputComponent extends ControlBase {
    constructor() {
        super(...arguments);
        this.searchButtonClick = new EventEmitter();
        this.readonly = false;
        this.placeholder = '';
        this.type = 'text';
        this.customButtons = [];
    }
    createControl() {
        return new Promise((complete) => {
            const originalElement = $(this.input.nativeElement);
            ObjectHelper.hide(originalElement);
            if (this.clonedElement) {
                this.clonedElement.parent().remove();
            }
            this.clonedElement = originalElement.clone();
            ObjectHelper.show(this.clonedElement);
            originalElement.parent().append(this.clonedElement);
            this.inputObj = this.clonedElement.input({
                customButtons: this.customButtons,
                onSearchButtonClick: (val) => this.searchButtonClick.emit(val)
            }).data('input');
            this.clonedElement.one('blur', () => {
                this.touchCallback();
            });
            this.clonedElement.on('keydown change', (event) => {
                asapScheduler.schedule(() => {
                    let newValue = this.clonedElement.val();
                    if (this.type === 'number') {
                        newValue = +newValue;
                    }
                    this.changeValue(newValue);
                }, 1);
            });
            complete();
        });
    }
    disable(disabled) {
        if (disabled) {
            this.inputObj.disable();
        }
        else {
            this.inputObj.enable();
        }
    }
    newValue() {
        if (!this.inputObj) {
            return;
        }
        this.clonedElement.val(this.innerValue);
    }
    newClassValue(newClasses, oldClasses) {
        if (this.clonedElement) {
            const target = this.clonedElement.parent();
            oldClasses.forEach((cls) => {
                target.removeClass(cls);
            });
            newClasses.forEach((cls) => {
                target.addClass(cls);
            });
        }
    }
};
__decorate([
    Output('search-button-click'),
    __metadata("design:type", Object)
], InputComponent.prototype, "searchButtonClick", void 0);
__decorate([
    Input('readonly'),
    __metadata("design:type", Object)
], InputComponent.prototype, "readonly", void 0);
__decorate([
    Input('placeholder'),
    __metadata("design:type", Object)
], InputComponent.prototype, "placeholder", void 0);
__decorate([
    Input('type'),
    __metadata("design:type", String)
], InputComponent.prototype, "type", void 0);
__decorate([
    Input('default-value'),
    __metadata("design:type", Object)
], InputComponent.prototype, "defaultValue", void 0);
__decorate([
    Input('size'),
    __metadata("design:type", Number)
], InputComponent.prototype, "size", void 0);
__decorate([
    Input('prepend'),
    __metadata("design:type", String)
], InputComponent.prototype, "prepend", void 0);
__decorate([
    Input('append'),
    __metadata("design:type", String)
], InputComponent.prototype, "append", void 0);
__decorate([
    Input('clear-button'),
    __metadata("design:type", Boolean)
], InputComponent.prototype, "clearButton", void 0);
__decorate([
    Input('clear-button-icon'),
    __metadata("design:type", String)
], InputComponent.prototype, "clearButtonIcon", void 0);
__decorate([
    Input('reveal-button'),
    __metadata("design:type", Boolean)
], InputComponent.prototype, "revealButton", void 0);
__decorate([
    Input('reveal-button-icon'),
    __metadata("design:type", String)
], InputComponent.prototype, "revealButtonIcon", void 0);
__decorate([
    Input('custom-buttons'),
    __metadata("design:type", Array)
], InputComponent.prototype, "customButtons", void 0);
__decorate([
    Input('search-button'),
    __metadata("design:type", Boolean)
], InputComponent.prototype, "searchButton", void 0);
__decorate([
    Input('search-button-icon'),
    __metadata("design:type", String)
], InputComponent.prototype, "searchButtonIcon", void 0);
__decorate([
    Input('autocomplete'),
    __metadata("design:type", Array)
], InputComponent.prototype, "autocomplete", void 0);
__decorate([
    Input('autocomplete-list-height'),
    __metadata("design:type", Number)
], InputComponent.prototype, "autocompleteListHeight", void 0);
__decorate([
    Input('cls-component'),
    __metadata("design:type", String)
], InputComponent.prototype, "clsComponent", void 0);
__decorate([
    Input('cls-input'),
    __metadata("design:type", String)
], InputComponent.prototype, "clsInput", void 0);
__decorate([
    Input('cls-prepend'),
    __metadata("design:type", String)
], InputComponent.prototype, "clsPrepend", void 0);
__decorate([
    Input('cls-append'),
    __metadata("design:type", String)
], InputComponent.prototype, "clsAppend", void 0);
__decorate([
    Input('cls-clear-button'),
    __metadata("design:type", String)
], InputComponent.prototype, "clsClearButton", void 0);
__decorate([
    Input('cls-reveal-button'),
    __metadata("design:type", String)
], InputComponent.prototype, "clsRevealButton", void 0);
__decorate([
    Input('cls-custom-button'),
    __metadata("design:type", String)
], InputComponent.prototype, "clsCustomButton", void 0);
__decorate([
    ViewChild('input', { static: true }),
    __metadata("design:type", ElementRef)
], InputComponent.prototype, "input", void 0);
InputComponent = InputComponent_1 = __decorate([
    Component({
        selector: 'm4-input',
        template: "<input [type]=\"type\" #input\r\n\r\n       [readonly]=\"readonly\"\r\n       [placeholder]=\"placeholder\"\r\n\r\n       [attr.data-default-value]=\"defaultValue\"\r\n       [attr.data-size]=\"size\"\r\n       [attr.data-prepend]=\"prepend\"\r\n       [attr.data-append]=\"append\"\r\n       [attr.data-clear-button]=\"clearButton\"\r\n       [attr.data-clear-button-icon]=\"clearButtonIcon\"\r\n       [attr.data-reveal-button]=\"revealButton\"\r\n       [attr.data-reveal-button-icon]=\"revealButtonIcon\"\r\n       [attr.data-search-button]=\"searchButton\"\r\n       [attr.data-search-button-icon]=\"searchButtonIcon\"\r\n       data-search-button-click=\"custom\"\r\n       [attr.data-autocomplete]=\"autocomplete?.join(',')\"\r\n       [attr.data-autocomplete-list-height]=\"autocompleteListHeight\"\r\n\r\n       [attr.data-cls-component]=\"clsComponent\"\r\n       [attr.data-cls-input]=\"clsInput\"\r\n       [attr.data-cls-prepend]=\"clsPrepend\"\r\n       [attr.data-cls-append]=\"clsAppend\"\r\n       [attr.data-cls-clear-button]=\"clsClearButton\"\r\n       [attr.data-cls-reveal-button]=\"clsRevealButton\"\r\n       [attr.data-cls-custom-button]=\"clsCustomButton\">\r\n",
        providers: [DefaultValueAccessor.get(InputComponent_1), TypeAlias.get(InputComponent_1)],
        encapsulation: ViewEncapsulation.None,
        changeDetection: ChangeDetectionStrategy.OnPush,
        styles: ["m4-input .autocomplete-list{z-index:1000}"]
    })
], InputComponent);
export { InputComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5wdXQuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vbmctbWV0cm80LyIsInNvdXJjZXMiOlsibGliL2Zvcm0vaW5wdXQvaW5wdXQuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsT0FBTyxFQUNMLHVCQUF1QixFQUN2QixTQUFTLEVBQ1QsVUFBVSxFQUNWLFlBQVksRUFDWixLQUFLLEVBQ0wsTUFBTSxFQUFFLFNBQVMsRUFDakIsaUJBQWlCLEVBQ2xCLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBQyxXQUFXLEVBQUMsTUFBTSxpQkFBaUIsQ0FBQztBQUM1QyxPQUFPLEVBQUMsb0JBQW9CLEVBQUMsTUFBTSxxQ0FBcUMsQ0FBQztBQUN6RSxPQUFPLEVBQUMsU0FBUyxFQUFDLE1BQU0seUJBQXlCLENBQUM7QUFDbEQsT0FBTyxFQUFDLGFBQWEsRUFBQyxNQUFNLE1BQU0sQ0FBQztBQUNuQyxPQUFPLEVBQUMsWUFBWSxFQUFDLE1BQU0sNEJBQTRCLENBQUM7QUFheEQsSUFBYSxjQUFjLHNCQUEzQixNQUFhLGNBQWUsU0FBUSxXQUEwQjtJQUE5RDs7UUFDaUMsc0JBQWlCLEdBQUcsSUFBSSxZQUFZLEVBQWlCLENBQUM7UUFFbEUsYUFBUSxHQUFHLEtBQUssQ0FBQztRQUNkLGdCQUFXLEdBQUcsRUFBRSxDQUFDO1FBQ3hCLFNBQUksR0FBYyxNQUFNLENBQUM7UUFTZixrQkFBYSxHQUFxRCxFQUFFLENBQUM7SUFxRmhHLENBQUM7SUFuRUMsYUFBYTtRQUNYLE9BQU8sSUFBSSxPQUFPLENBQU8sQ0FBQyxRQUFRLEVBQUUsRUFBRTtZQUNwQyxNQUFNLGVBQWUsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsQ0FBQztZQUNwRCxZQUFZLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDO1lBRW5DLElBQUksSUFBSSxDQUFDLGFBQWEsRUFBRTtnQkFDdEIsSUFBSSxDQUFDLGFBQWEs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QUMsR0FBRyxDQUFDLGdCQUFjLENBQUMsRUFBRSxTQUFTLENBQUMsR0FBRyxDQUFDLGdCQUFjLENBQUMsQ0FBQztRQUNwRixhQUFhLEVBQUUsaUJBQWlCLENBQUMsSUFBSTtRQUNyQyxlQUFlLEVBQUUsdUJBQXVCLENBQUMsTUFBTTs7S0FDaEQsQ0FBQztHQUNXLGNBQWMsQ0FtRzFCO1NBbkdZLGNBQWMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LFxyXG4gIENvbXBvbmVudCxcclxuICBFbGVtZW50UmVmLFxyXG4gIEV2ZW50RW1pdHRlcixcclxuICBJbnB1dCxcclxuICBPdXRwdXQsIFZpZXdDaGlsZCxcclxuICBWaWV3RW5jYXBzdWxhdGlvblxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQge0NvbnRyb2xCYXNlfSBmcm9tICcuLi9jb250cm9sLWJhc2UnO1xyXG5pbXBvcnQge0RlZmF1bHRWYWx1ZUFjY2Vzc29yfSBmcm9tICcuLi8uLi9oZWxwZXIvZGVmYXVsdC12YWx1ZS1hY2Nlc3Nvcic7XHJcbmltcG9ydCB7VHlwZUFsaWFzfSBmcm9tICcuLi8uLi9oZWxwZXIvdHlwZS1hbGlhcyc7XHJcbmltcG9ydCB7YXNhcFNjaGVkdWxlcn0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7T2JqZWN0SGVscGVyfSBmcm9tICcuLi8uLi9oZWxwZXIvb2JqZWN0LWhlbHBlcic7XHJcbmltcG9ydCB7SW5wdXRUeXBlfSBmcm9tICcuLi8uLi9oZWxwZXIvdHlwZXMnO1xyXG5cclxuZGVjbGFyZSB2YXIgJDogYW55O1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdtNC1pbnB1dCcsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL2lucHV0LmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6IFsnLi9pbnB1dC5jb21wb25lbnQuY3NzJ10sXHJcbiAgcHJvdmlkZXJzOiBbRGVmYXVsdFZhbHVlQWNjZXNzb3IuZ2V0KElucHV0Q29tcG9uZW50KSwgVHlwZUFsaWFzLmdldChJbnB1dENvbXBvbmVudCldLFxyXG4gIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmUsXHJcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2hcclxufSlcclxuZXhwb3J0IGNsYXNzIElucHV0Q29tcG9uZW50IGV4dGVuZHMgQ29udHJvbEJhc2U8c3RyaW5nfG51bWJlcj4ge1xyXG4gIEBPdXRwdXQoJ3NlYXJjaC1idXR0b24tY2xpY2snKSBzZWFyY2hCdXR0b25DbGljayA9IG5ldyBFdmVudEVtaXR0ZXI8c3RyaW5nfG51bWJlcj4oKTtcclxuXHJcbiAgQElucHV0KCdyZWFkb25seScpIHJlYWRvbmx5ID0gZmFsc2U7XHJcbiAgQElucHV0KCdwbGFjZWhvbGRlcicpIHBsYWNlaG9sZGVyID0gJyc7XHJcbiAgQElucHV0KCd0eXBlJykgdHlwZTogSW5wdXRUeXBlID0gJ3RleHQnO1xyXG4gIEBJbnB1dCgnZGVmYXVsdC12YWx1ZScpIGRlZmF1bHRWYWx1ZTogYW55O1xyXG4gIEBJbnB1dCgnc2l6ZScpIHNpemU6IG51bWJlcjtcclxuICBASW5wdXQoJ3ByZXBlbmQnKSBwcmVwZW5kOiBzdHJpbmc7XHJcbiAgQElucHV0KCdhcHBlbmQnKSBhcHBlbmQ6IHN0cmluZztcclxuICBASW5wdXQoJ2NsZWFyLWJ1dHRvbicpIGNsZWFyQnV0dG9uOiBib29sZWFuO1xyXG4gIEBJbnB1dCgnY2xlYXItYnV0dG9uLWljb24nKSBjbGVhckJ1dHRvbkljb246IHN0cmluZztcclxuICBASW5wdXQoJ3JldmVhbC1idXR0b24nKSByZXZlYWxCdXR0b246IGJvb2xlYW47XHJcbiAgQElucHV0KCdyZXZlYWwtYnV0dG9uLWljb24nKSByZXZlYWxCdXR0b25JY29uOiBzdHJpbmc7XHJcbiAgQElucHV0KCdjdXN0b20tYnV0dG9ucycpIGN1c3RvbUJ1dHRvbnM6IHsgaHRtbDogc3RyaW5nLCBjbHM6IHN0cmluZywgb25jbGljazogc3RyaW5nIH1bXSA9IFtdO1xyXG4gIEBJbnB1dCgnc2VhcmNoLWJ1dHRvbicpIHNlYXJjaEJ1dHRvbjogYm9vbGVhbjtcclxuICBASW5wdXQoJ3NlYXJjaC1idXR0b24taWNvbicpIHNlYXJjaEJ1dHRvbkljb246IHN0cmluZztcclxuICBASW5wdXQoJ2F1dG9jb21wbGV0ZScpIGF1dG9jb21wbGV0ZTogc3RyaW5nW107XHJcbiAgQElucHV0KCdhdXRvY29tcGxldGUtbGlzdC1oZWlnaHQnKSBhdXRvY29tcGxldGVMaXN0SGVpZ2h0OiBudW1iZXI7XHJcblxyXG4gIEBJbnB1dCgnY2xzLWNvbXBvbmVudCcpIGNsc0NvbXBvbmVudDogc3RyaW5nO1xyXG4gIEBJbnB1dCgnY2xzLWlucHV0JykgY2xzSW5wdXQ6IHN0cmluZztcclxuICBASW5wdXQoJ2Nscy1wcmVwZW5kJykgY2xzUHJlcGVuZDogc3RyaW5nO1xyXG4gIEBJbnB1dCgnY2xzLWFwcGVuZCcpIGNsc0FwcGVuZDogc3RyaW5nO1xyXG4gIEBJbnB1dCgnY2xzLWNsZWFyLWJ1dHRvbicpIGNsc0NsZWFyQnV0dG9uOiBzdHJpbmc7XHJcbiAgQElucHV0KCdjbHMtcmV2ZWFsLWJ1dHRvbicpIGNsc1JldmVhbEJ1dHRvbjogc3RyaW5nO1xyXG4gIEBJbnB1dCgnY2xzLWN1c3RvbS1idXR0b24nKSBjbHNDdXN0b21CdXR0b246IHN0cmluZztcclxuXHJcbiAgQFZpZXdDaGlsZCgnaW5wdXQnLCB7IHN0YXRpYzogdHJ1ZSB9KSBwcml2YXRlIGlucHV0OiBFbGVtZW50UmVmO1xyXG4gIHByaXZhdGUgaW5wdXRPYmo6IGFueTtcclxuICBwcml2YXRlIGNsb25lZEVsZW1lbnQ6IGFueTtcclxuXHJcbiAgY3JlYXRlQ29udHJvbCgpIHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZTx2b2lkPigoY29tcGxldGUpID0+IHtcclxuICAgICAgY29uc3Qgb3JpZ2luYWxFbGVtZW50ID0gJCh0aGlzLmlucHV0Lm5hdGl2ZUVsZW1lbnQpO1xyXG4gICAgICBPYmplY3RIZWxwZXIuaGlkZShvcmlnaW5hbEVsZW1lbnQpO1xyXG5cclxuICAgICAgaWYgKHRoaXMuY2xvbmVkRWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuY2xvbmVkRWxlbWVudC5wYXJlbnQoKS5yZW1vdmUoKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdGhpcy5jbG9uZWRFbGVtZW50ID0gb3JpZ2luYWxFbGVtZW50LmNsb25lKCk7XHJcbiAgICAgIE9iamVjdEhlbHBlci5zaG93KHRoaXMuY2xvbmVkRWxlbWVudCk7XHJcbiAgICAgIG9yaWdpbmFsRWxlbWVudC5wYXJlbnQoKS5hcHBlbmQodGhpcy5jbG9uZWRFbGVtZW50KTtcclxuXHJcbiAgICAgIHRoaXMuaW5wdXRPYmogPSB0aGlzLmNsb25lZEVsZW1lbnQuaW5wdXQoe1xyXG4gICAgICAgIGN1c3RvbUJ1dHRvbnM6IHRoaXMuY3VzdG9tQnV0dG9ucyxcclxuICAgICAgICBvblNlYXJjaEJ1dHRvbkNsaWNrOiAodmFsKSA9PiB0aGlzLnNlYXJjaEJ1dHRvbkNsaWNrLmVtaXQodmFsKVxyXG4gICAgICB9KS5kYXRhKCdpbnB1dCcpO1xyXG5cclxuICAgICAgdGhpcy5jbG9uZWRFbGVtZW50Lm9uZSgnYmx1cicsICgpID0+IHtcclxuICAgICAgICB0aGlzLnRvdWNoQ2FsbGJhY2soKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICB0aGlzLmNsb25lZEVsZW1lbnQub24oJ2tleWRvd24gY2hhbmdlJywgKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgYXNhcFNjaGVkdWxlci5zY2hlZHVsZSgoKSA9PiB7XHJcbiAgICAgICAgICBsZXQgbmV3VmFsdWUgPSB0aGlzLmNsb25lZEVsZW1lbnQudmFsKCk7XHJcblxyXG4gICAgICAgICAgaWYgKHRoaXMudHlwZSA9PT0gJ251bWJlcicpIHtcclxuICAgICAgICAgICAgbmV3VmFsdWUgPSArbmV3VmFsdWU7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgdGhpcy5jaGFuZ2VWYWx1ZShuZXdWYWx1ZSk7XHJcbiAgICAgICAgfSwgMSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgY29tcGxldGUoKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGlzYWJsZShkaXNhYmxlZDogYm9vbGVhbik6IHZvaWQge1xyXG4gICAgaWYgKGRpc2FibGVkKSB7XHJcbiAgICAgIHRoaXMuaW5wdXRPYmouZGlzYWJsZSgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5pbnB1dE9iai5lbmFibGUoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG5ld1ZhbHVlKCk6IHZvaWQge1xyXG4gICAgaWYgKCF0aGlzLmlucHV0T2JqKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmNsb25lZEVsZW1lbnQudmFsKHRoaXMuaW5uZXJWYWx1ZSk7XHJcbiAgfVxyXG5cclxuICBuZXdDbGFzc1ZhbHVlKG5ld0NsYXNzZXM6IHN0cmluZ1tdLCBvbGRDbGFzc2VzOiBzdHJpbmdbXSkge1xyXG4gICAgaWYgKHRoaXMuY2xvbmVkRWxlbWVudCkge1xyXG4gICAgICBjb25zdCB0YXJnZXQgPSB0aGlzLmNsb25lZEVsZW1lbnQucGFyZW50KCk7XHJcblxyXG4gICAgICBvbGRDbGFzc2VzLmZvckVhY2goKGNsczogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgdGFyZ2V0LnJlbW92ZUNsYXNzKGNscyk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgbmV3Q2xhc3Nlcy5mb3JFYWNoKChjbHM6IHN0cmluZykgPT4ge1xyXG4gICAgICAgIHRhcmdldC5hZGRDbGFzcyhjbHMpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIl19